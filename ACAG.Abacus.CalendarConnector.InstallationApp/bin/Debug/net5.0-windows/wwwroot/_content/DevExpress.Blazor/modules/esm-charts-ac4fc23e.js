import"./esm-chunk-d81494b9.js";import{ensureElement as e,elementHasCssClass as t,changeDom as n,calculateStyles as o,getCurrentStyle as i,toggleCssClass as r}from"./esm-dom-utils-c40cd314.js";import{a as l}from"./esm-chunk-9c16a801.js";import"./esm-chunk-13e2cf5f.js";import{parseTranslateInfo as u,translatePosition as c}from"./esm-popup-utils-32033e18.js";class s{constructor(e,t){this.widget=t,this.chartElement=s.getChartElement(e)}static getChartElement(e){return e.querySelector(".dx-chart")}}const a=new Map;function d(e){const t=a.get(e);return void 0===t?Promise.reject():t.widget}function f(e,t,n){const o=a.get(e);if(void 0===o||o.chartElement!==s.getChartElement(e)){const o=function(e,t,n){return new Promise((function(o){import("./esm-devexpress.viz-5d8db4bd.js").then((function(i){const r=p(i,s.getChartElement(e),t,o);n(t,r)}))}))}(e,t,n);return a.set(e,new s(e,o)),o}return o.widget.then((function(e){return new Promise((function(o){n(t,(function(t){t.animation={enabled:!1},e.option(t),o("ok")}))}))})).catch(window.console.error)}function p(e,t,n,o){const i=n.series.map(e=>e.category)[0],r="pie"===i||"donut"===i?e.viz.dxPieChart:e.viz.dxChart;return function(e){e.type=i,o(new r(t,e))}}function m(e,t,n,o,i,r){i.forEach((function(i){l(e,i,(function(e){const i=g(t,n,o);i&&r(i)}))}))}function g(e,t,n){let o=e.getSeriesByPos(t);return n&&(o=o.getPoints().filter((function(e){return e.tag===n}))[0]),o}function h(e,n,o,i,r){if(!e)return;const l=g(n,o,i);if(!l)return;const u=e.querySelector(".dx-chart-legend-icon");if(u){const e=l.getColor();t(u,"dx-chart-def-icon")&&(u.style.backgroundColor=e),u.style.color=e}r||(m(e,n,o,i,["mouseover","focusin"],(function(e){e.hover(n.option("legend.hoverMode"))})),m(e,n,o,i,["mouseout","focusout"],(function(e){e.clearHover()})))}function v(t,n){let i=null,r=null,l=null;const u={},c={};let s=-1,a=null;function d(t,r){const l=t.tag;clearTimeout(s),s=setTimeout((function(){i=l,n.invokeMethodAsync("GetTooltipTemplate",[l]).then((function(t){return t=e(t),c[l]=t,function(e,t){return o((function(){const n=e.getBoundingClientRect();return`<div id="_${t}" class="dx-chart-tooltip-wrapper" style="width: ${n.width}px; height: ${n.height}px;"></div>`}))}(t,l)})).then((function(e){u[l]=e,i===l&&(a=t,r())})).catch((function(e){window.console.error(e)}))}),100)}function f(e){var t;r=null,l&&(t=l,void import("./esm-popup-utils-32033e18.js").then((function(e){e.hide(t)})),l=null)}t.tooltip={enabled:!0,paddingLeftRight:0,paddingTopBottom:0,customizeTooltip:function(e){return u[e.point.tag]?{html:u[e.point.tag]}:(d(e.point,(function(){e.point.showTooltip()})),{text:""})}},t.onTooltipHidden=function(e){f()},t.onTooltipShown=function(e){f();let t=e.target;if(!t){if(t=a,!t)return;a=null}const n=t.tag;u[n]&&(r=n,import("./esm-popup-utils-32033e18.js").then((function(e){r===n&&(l=c[n],e.show(l,document.getElementById("_"+n),"top-sides left-sides"))})))}}function w(e,t){return e._valueAxes.filter((function(e){return e.pane===t.name}))[0]}const b={init:function(e,t,l){return f(e,t,(function(t,s){!function(e,t){if(e.palette)return t(e.palette);const r=["bg-primary","bg-success","bg-danger","bg-warning","bg-info","bg-secondary"],l=document.createElement("DIV");l.className="d-none position-absolute";for(let e=0;e<r.length;e++){const t=document.createElement("DIV");t.className=r[e],l.appendChild(t)}n((function(){document.body.appendChild(l),o((function(){const e=[];for(let t=0;t<l.childNodes.length;t++)e.push(i(l.childNodes[t]).backgroundColor);n((function(){document.body.removeChild(l),t(e)}))}))}))}(t,(function(i){let a=!1;const d={tooltip:t.tooltip,dataSource:t.dataSource,palette:i,rotated:t.rotated,resolveLabelOverlapping:t.labelOverlap,size:t.size,commonAxisSettings:{label:{overlappingBehavior:"rotate",rotationAngle:45}},dataPrepareSettings:{sortingMethod:!1},commonSeriesSettings:{argumentField:"argument",valueField:"value",openValueField:"openValue",highValueField:"highValue",lowValueField:"lowValue",closeValueField:"closeValue",rangeValue1Field:"startValue",rangeValue2Field:"endValue",sizeField:"size",type:"bar"},adaptiveLayout:{width:0,height:0},seriesTemplate:{nameField:"seriesId",customizeSeries:function(e){return t.series.filter((function(t){return t.seriesId===e}))[0]}},customizeLabel:function(e){return e.data.pointLabel},customizePoint:function(e){return e.data.pointAppearance},legend:{visible:!1,hoverMode:(t.legend?t.legend.hoverMode:null)||"includepoints"},onDrawn:function(t){a||(a=!0,function(e,t){const n=e.querySelectorAll(".dx-chart-legend-item");for(let e=0;e<n.length;e++){const o=n[e],i=+o.getAttribute("data-series"),r=o.getAttribute("data-point");h(o,t,i,r,!0)}}(e,t.component),function(e,t){function i(e,t){n((function(){c(e,0,t)}))}function r(e,t,n,o,r){i(e,o),e.marginTop="-"+r+"px",i(t,-r),i(n,-r)}t.panes&&0!==t.panes.filter((function(e){return"default"!==e.name})).length&&o((function(){let o=0;for(let n=t.panes.length-2;n>=0;n--){const l=t.panes[n],c=e.querySelector(".dx-chart-legend[data-pane='"+l.name+"']");if(c){const e=c.offsetHeight+o,n=w(t,l),s=n._axisGroup.element,a=n._axisGridGroup.element,d=a.getBoundingClientRect().bottom+10,f=u(c.style),p=c.getBoundingClientRect().top-f.top;t.series.filter((function(e){return e.pane===l.name})).forEach((function(t){i(t._group.element.style,-e)})),r(c.style,s.style,a.style,d-p,e),o+=e}}n((function(){t.option("margin",{top:o})}))}))}(e,t.component),r(e,"dx-loading",!1))},valueAxis:t.valueAxis,panes:t.panes,argumentAxis:t.argumentAxis,pathModified:!0};t.hasTooltipCustomization?v(d,l):d.tooltip=t.tooltip,s(d)}))})).then((function(){return Promise.resolve("ok")})).catch((function(e){window.console.error(e)}))},dispose:function(t){if(t=e(t))return function(t,n){t=e(t);const o=a.get(t);return void 0!==o&&(o.chartElement=null,o.widget=null,n&&a.delete(t)),Promise.resolve("ok")}(t,!0)},onSeriesLegendElementReceived:function(e,t,n,o){return d(e).then((function(e){return h(o,e,t,n),Promise.resolve()})).catch((function(e){window.console.error(e)}))},onSeriesVisibleChanged:function(e,t,n,o){return d(e).then((function(e){const i=g(e,t,n);return o?i.show():i.hide(),Promise.resolve()})).catch((function(e){window.console.error(e)}))},destroyTooltips:function(){return new Promise((function(e,t){const n=Array.prototype.slice.call(document.querySelectorAll(".dxc-tooltip"));for(let e=0;e<n.length;e++){const t=n[e];t.parentNode.removeChild(t)}e(!0)}))}};export default b;export{p as createWidgetBuilder};
